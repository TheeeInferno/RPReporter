<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SAST CAD</title>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<style>
:root {
  --bg-color: #1b1b1b;
  --text-color: #eee;
  --card-bg: #2b2b2b;
  --accent: #3a7afe;
  --input-bg: #1e1e1e;
}
[data-theme="day"] {
  --bg-color: #f5f5f5;
  --text-color: #111;
  --card-bg: #fff;
  --accent: #3a7afe;
  --input-bg: #e0e0e0;
}
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  margin:0; padding:0;
  background: var(--bg-color);
  color: var(--text-color);
}
header {
  background: #222;
  display: flex; justify-content: space-between; align-items: center;
  padding: 10px 20px;
  color: var(--accent);
  font-size: 24px;
  font-weight: bold;
  border-bottom: 2px solid var(--accent);
}
#time { font-size: 16px; color: var(--text-color); margin-right:10px; }
.toggle-btn {
  background: var(--accent); border:none; color:#fff; padding:5px 10px; border-radius:4px; cursor:pointer; font-weight:bold;
}
.wrapper { display:flex; height: calc(100vh - 52px); }
.sidebar {
  width:200px; background: #222; display:flex; flex-direction:column;
}
.sidebar button {
  background:none; border:none; color: var(--text-color); padding: 15px; text-align:left; cursor:pointer; font-size:16px;
  border-bottom:1px solid #333; transition:0.2s;
}
.sidebar button:hover { background: #333; }
.sidebar button.active { background: #1e5eff; color:#fff; }
.main {
  flex:1; padding:20px; overflow:auto;
  background: var(--bg-color);
}
.box { background: var(--card-bg); padding:20px; border-radius:8px; box-shadow:0 2px 10px rgba(0,0,0,0.3); }
label { display:block; margin-top:10px; }
input, textarea, select, button { width:100%; margin-top:5px; padding:8px; border-radius:4px; border:none; background: var(--input-bg); color: var(--text-color); }
textarea{ resize: vertical;}
button.generate { background: var(--accent); color:#fff; font-weight:bold; margin-top:10px; cursor:pointer; transition:0.2s;}
button.generate:hover{ background:#1e5eff;}
#report { background: var(--card-bg); color: var(--text-color); padding:20px; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.3);}
.header{ text-align:center; font-weight:bold; font-size:20px; margin-bottom:10px; color: var(--accent);}
hr{ margin:10px 0; border:1px solid #ccc;}
.output{margin-top:10px; color: var(--accent);}
iframe{width:100%; height:400px; border:none; border-radius:6px; margin-top:10px;}
</style>
</head>
<body data-theme="night">

<header>
  SAST CAD
  <div>
    <span id="time"></span>
    <button class="toggle-btn" onclick="toggleTheme()">Toggle Day/Night</button>
  </div>
</header>

<div class="wrapper">
  <div class="sidebar">
    <button class="active" onclick="showSection('reports', this)">Reports</button>
    <button onclick="showSection('documents', this)">Documents</button>
    <button onclick="showSection('roster', this)">Roster</button>
    <button onclick="showSection('laws', this)">Public Laws</button>
  </div>
  <div class="main">
    <!-- Reports Section -->
    <div id="reports" class="section box">
      <label>Choose Report Type</label>
      <select id="reportType" onchange="loadForm()">
        <option value="arrest">Arrest Report</option>
        <option value="trespass">Trespass Notice</option>
        <option value="incident">Incident Report</option>
        <option value="force">Use of Force</option>
      </select>
      <div id="form-content"></div>
      <button class="generate" onclick="upload()">Upload to Imgur</button>
      <div class="output" id="link"></div>
      <div id="report">
        <div class="header">Generated Report</div>
        <hr>
        <div id="preview">Preview will appear here</div>
      </div>
    </div>

    <!-- Documents Section -->
    <div id="documents" class="section box" style="display:none;">
      <div class="header">SAST Documents</div>
      <a href="#" onclick="loadDoc('https://drive.google.com/drive/folders/1NdlwfYhK0Pu5hZ2FeLSB39xGkcv8Wo6h?usp=sharing')">Open Document Folder</a>
      <iframe id="docFrame"></iframe>
    </div>

    <!-- Roster Section -->
    <div id="roster" class="section box" style="display:none;">
      <div class="header">SAST Roster</div>
      <iframe src="https://docs.google.com/spreadsheets/d/1v3jbD_9itIsc7wRLc8yHK52sDGYss1LV7I-Wu1kJfls/preview"></iframe>
    </div>

    <!-- Public Laws Section -->
    <div id="laws" class="section box" style="display:none;">
      <div class="header">State & Federal Charges</div>
      <iframe src="https://docs.google.com/spreadsheets/d/1XvDGf6q1QcnUfrnKHJPX4h5r8s7-M5eSu4vhH7_28xc/preview"></iframe>
    </div>
  </div>
</div>

<script>
// Sidebar section switching
function showSection(id, btn){
  document.querySelectorAll('.sidebar button').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  document.querySelectorAll('.section').forEach(s => s.style.display='none');
  document.getElementById(id).style.display='block';
}

// Reports forms
const forms = {
  arrest: `
    <label>Officer Name</label><input id="officer">
    <label>Badge Number</label><input id="badge">
    <label>Suspect Name</label><input id="suspect">
    <label>Location</label><input id="location">
    <label>Charges</label><input id="charges">
    <label>Narrative</label><textarea id="narrative" rows="6"></textarea>
    <button class="generate" onclick="generate('Arrest Report')">Generate Preview</button>
  `,
  trespass: `
    <label>Officer Name</label><input id="officer">
    <label>Badge Number</label><input id="badge">
    <label>Person Name</label><input id="suspect">
    <label>Location</label><input id="location">
    <label>Reason</label><input id="charges">
    <label>Narrative</label><textarea id="narrative" rows="4"></textarea>
    <button class="generate" onclick="generate('Trespass Notice')">Generate Preview</button>
  `,
  incident: `
    <label>Officer Name</label><input id="officer">
    <label>Badge Number</label><input id="badge">
    <label>Involved Persons</label><input id="suspect">
    <label>Location</label><input id="location">
    <label>Incident Type</label><input id="charges">
    <label>Narrative</label><textarea id="narrative" rows="6"></textarea>
    <button class="generate" onclick="generate('Incident Report')">Generate Preview</button>
  `,
  force: `
    <label>Officer Name</label><input id="officer">
    <label>Badge Number</label><input id="badge">
    <label>Suspect Name</label><input id="suspect">
    <label>Location</label><input id="location">
    <label>Force Used</label><input id="charges">
    <label>Narrative</label><textarea id="narrative" rows="6"></textarea>
    <button class="generate" onclick="generate('Use of Force Report')">Generate Preview</button>
  `
};

function loadForm() {
  const type = document.getElementById('reportType').value;
  document.getElementById('form-content').innerHTML = forms[type];
  document.getElementById('preview').innerHTML = "Preview will appear here";
  document.getElementById('link').innerHTML = "";
}

function generate(type){
  const officer = document.getElementById('officer')?.value || '';
  const badge = document.getElementById('badge')?.value || '';
  const suspect = document.getElementById('suspect')?.value || '';
  const location = document.getElementById('location')?.value || '';
  const charges = document.getElementById('charges')?.value || '';
  const narrative = document.getElementById('narrative')?.value || '';
  document.getElementById('preview').innerHTML=`
    <strong>Report Type:</strong> ${type}<br><br>
    <strong>Officer:</strong> ${officer} (Badge ${badge})<br>
    ${suspect?`<strong>Suspect/Person:</strong> ${suspect}<br>`:''}
    <strong>Location:</strong> ${location}<br>
    ${charges?`<strong>Details:</strong> ${charges}<br>`:''}
    <strong>Date/Time:</strong> ${new Date().toLocaleString()}<br><br>
    <strong>Narrative:</strong><br>${narrative.replace(/\n,"<br>")}
  `;
}

async function upload(){
  const report = document.getElementById("report");
  const canvas = await html2canvas(report, {scale:2});
  const image = canvas.toDataURL("image/png").split(",")[1];

  const res = await fetch("https://api.imgur.com/3/image",{
    method:"POST",
    headers:{
      Authorization:"Client-ID YOUR_IMGUR_CLIENT_ID",
      "Content-Type":"application/json"
    },
    body:JSON.stringify({image})
  });

  const data = await res.json();
  if(data.success){
    document.getElementById("link").innerHTML=`Uploaded: <a href="${data.data.link}" target="_blank">${data.data.link}</a>`;
  }else{ document.getElementById("link").innerText="Upload failed";}
}

function toggleTheme(){
  document.body.dataset.theme = document.body.dataset.theme==='night'?'day':'night';
}

function updateTime(){
  const now = new Date();
  document.getElementById('time').innerText = now.toLocaleTimeString();
}
setInterval(updateTime,1000); updateTime();

function loadDoc(url){ document.getElementById('docFrame').src = url; }

// Initialize
loadForm();
</script>

</body>
</html>
